import{a as u}from"./axios-4a70c6fc.js";import{s as g}from"./index-e8320816.js";import{E as i,p as m}from"./element-plus-faba5d50.js";const c=function(s){let e="未知错误";switch(s){case 400:e="错误的请求";break;case 401:e="未授权，请重新登录";break;case 403:e="拒绝访问";break;case 404:e="请求错误,未找到该资源";break;case 405:e="请求方法未允许";break;case 408:e="请求超时";break;case 500:e="服务器端出错";break;case 501:e="网络未实现";break;case 502:e="网络错误";break;case 503:e="服务不可用";break;case 504:e="网络超时";break;case 505:e="http版本不支持该请求";break;default:e=`其他连接错误 --${s}`}return e},a=u.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});let o,r=0;const d=()=>{r===0&&!o&&(o=m.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.05)"})),r++},l=()=>{r--,r==0&&o.close()};a.interceptors.request.use(s=>{var e,t;return d(),s.headers.token=((e=JSON.parse(sessionStorage.getItem("user")))==null?void 0:e.token)||((t=JSON.parse(localStorage.getItem("user")))==null?void 0:t.token),s},s=>{Promise.reject(s)});a.interceptors.response.use(s=>{l();const e=s.data.status||200,t=c(e)||s.data.msg||c("default");if(e===200)return Promise.resolve(s.data);if(e===401||s.status===401)return i.error(t),localStorage.removeItem("user"),g.commit("user/removeToken"),s.config.url!="/login"&&window.open("/","_self"),Promise.reject(s.data)},s=>{var t,n;l();let{message:e}=s;return e=="Network Error"?e="后端接口连接异常":e.includes("timeout")?e="系统接口请求超时":e.includes("Request failed with status code")&&(e.substr(e.length-3)==403?e="权限不足,拒绝访问":e.substr(e.length-3)==500?e="系统故障":e.substr(e.length-3)==401?((t=JSON.parse(sessionStorage.getItem("user")))!=null&&t.token||((n=JSON.parse(localStorage.getItem("user")))==null||n.token),sessionStorage.removeItem("user"),localStorage.removeItem("user"),e="未登录",window.open("/","_self")):e="系统接口"+e.substr(e.length-3)+"异常"),i.error({message:e,duration:3*1e3}),Promise.reject(s)});const b=(s="",e={},t={})=>a.get(s,{params:e},t),S=(s="",e={},t={})=>a.post(s,e,t);export{b as G,S as P};
